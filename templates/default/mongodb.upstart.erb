description "MongoDB"

start on runlevel [2345]
stop on runlevel [!2345]

limit fsize <%= node.mongodb.ulimit.file_size %>
limit cpu<%= node.mongodb.ulimit.cpu_time %>
limit as <%= node.mongodb.ulimit.virtual_memory %>
limit nofile <%= node.mongodb.ulimit.open_files %>
limit rss <%= node.mongodb.ulimit.memory_size %>
limit noproc <%= node.mongodb.ulimit.processes %>

pre-start script
    mkdir -p /var/lib/mongodb/
    mkdir -p /var/log/mongodb/
end script

script
    ENABLE_MONGODB="yes"
    if [ -f /etc/default/mongodb ]; then
        . /etc/default/mongodb
    fi
    if [ "x$ENABLE_MONGODB" = "xyes" ]; then
        exec start-stop-daemon --start --quiet --chuid $DAEMON_USER \
            --exec $DAEMON -- $DAEMON_OPTS
    fi
end script
